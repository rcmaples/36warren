import type {QueryParams} from 'next-sanity'
import {client} from './client'

// Client-side fetch function that doesn't use next/headers
export async function clientSanityFetch<const QueryString extends string>({
  query,
  params = {},
}: {
  query: QueryString
  params?: QueryParams
}) {
  try {
    return await client.fetch(query, params, {
      perspective: 'published',
      useCdn: true,
      // Don't use next revalidation in client components
    })
  } catch (error) {
    console.error('Error fetching from Sanity:', error)
    throw error
  }
}
